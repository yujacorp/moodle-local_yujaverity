define("local_yujaverity/checkQuizAccess",["exports"],(function(_exports){function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function checkExtension(verityHostname){return new Promise((function(resolve,reject){var iframe=document.createElement("iframe");iframe.id="yuja-verity-extension-connect",iframe.style.display="none",iframe.style.visibility="hidden",iframe.src="https://"+verityHostname+"/resources/themes/extension-connect.html",document.body.appendChild(iframe),iframe.onload=function(){var _iframe$contentWindow;null===(_iframe$contentWindow=iframe.contentWindow)||void 0===_iframe$contentWindow||_iframe$contentWindow.postMessage({require:"exists"},"https://"+verityHostname)},iframe.onerror=function(){reject()},window.addEventListener("message",(function(ev){if(ev.origin==="https://"+verityHostname){var message=ev.data;"exists"===(null==message?void 0:message.require)&&resolve(Boolean(message.result))}}))}))}function showBlockPage(verityHostname,blockPage){var quizDisplay=document.getElementById("region-main-box");if(quizDisplay){var notice=document.createElement("iframe");notice.id="yuja-download-instructions",notice.width=quizDisplay.offsetWidth,notice.scrolling="no",notice.src="https://"+verityHostname+"/pages/take-quiz/block-access/"+blockPage+".html?lms=moodle",notice.style.border="none",notice.style.transition="all 0.5s ease-in-out 0s",notice.height="0px",notice.width="100%",notice.style.paddingLeft="15px",notice.style.paddingRight="15px",quizDisplay.style.display="none",quizDisplay.style.visibility="hidden",quizDisplay.parentNode.appendChild(notice),notice.onload=function(){notice.contentWindow.postMessage({event:"init-auth-instructions",authLink:void 0},"https://"+verityHostname)},window.addEventListener("message",(function(ev){if(ev.origin==="https://"+verityHostname){var message=ev.data;"instructions-resize"===(null==message?void 0:message.event)&&(message.scrollHeight&&(notice.height=message.scrollHeight),message.scrollWidth&&(notice.width="100%"),message.noScroll||(document.documentElement.scrollTop=0))}}))}}function showQuiz(){document.body.classList.remove("yujaverity")}function _checkQuizAccess(){return(_checkQuizAccess=_asyncToGenerator(regeneratorRuntime.mark((function _callee(verityHostname){return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!window.chrome){_context.next=11;break}return _context.next=4,checkExtension(verityHostname);case 4:if(!_context.sent){_context.next=8;break}showQuiz(),_context.next=9;break;case 8:showBlockPage(verityHostname,"download-instructions");case 9:_context.next=12;break;case 11:showBlockPage(verityHostname,"browser-instructions");case 12:_context.next=16;break;case 14:_context.prev=14,_context.t0=_context.catch(0);case 16:case"end":return _context.stop()}}),_callee,null,[[0,14]])})))).apply(this,arguments)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.checkQuizAccess=function(_x){return _checkQuizAccess.apply(this,arguments)}}));

//# sourceMappingURL=checkQuizAccess.min.js.map